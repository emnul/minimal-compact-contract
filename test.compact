pragma language_version >= 0.21.0;

import CompactStandardLibrary;

export ledger mtHashed: MerkleTree<10, Bytes<32>>;
export ledger mtNoHash: MerkleTree<10, Field>;

witness getPathForFooHash(foo: Bytes<32>): MerkleTreePath<10, Bytes<32>>;
witness getPathForFooNoHash(foo: Field): MerkleTreePath<10, Field>;


export {MerkleTreePath};


export circuit insertFooHash(foo: Field): [] {
  mtHashed.insertHash(disclose(persistentHash<Field>(foo)));
}

export circuit insertFooNoHash(foo: Field): [] {
  mtNoHash.insert(disclose(foo));
}

export circuit proveMtMembershipNoLeafHash(foo: Field): Boolean {
  const witnessPath = getPathForFooHash(persistentHash<Field>(foo));
  // witnessPath is always default path because findPathForLeaf TS API cannot find a path
  const derivedMtPathRoot = merkleTreePathRootNoLeafHash<10>(witnessPath);
  return mtHashed.checkRoot(disclose(derivedMtPathRoot));
}

export circuit proveMtMembership(foo: Field): Boolean {
  const witnessPath = getPathForFooNoHash(foo);
  const derivedMtPathRoot = merkleTreePathRoot<10, Field>(witnessPath);
  return mtNoHash.checkRoot(disclose(derivedMtPathRoot));
}